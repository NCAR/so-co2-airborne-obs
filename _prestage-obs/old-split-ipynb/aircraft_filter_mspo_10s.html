
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Filter airborne 10-sec data &#8212; Strong Southern Ocean Carbon Uptake Evident in Airborne Observations</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/new-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Strong Southern Ocean Carbon Uptake Evident in Airborne Observations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data assets and preprocessing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../data-assets-preprocessing.html">
   Overview
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../_prestage-obs-instructions.html">
     Obtaining observational data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../table-s1.html">
     Station measurement records
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../_prestage-data.html">
     Prestage model data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_aircraft_10s.html">
     Process airborne 10-sec merge files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_aircraft_pfp.html">
     Process airborne PFP merge files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_aircraft_med.html">
     Process airborne Medusa merge files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../aircraft_obspack_merge.html">
     Merge flight parameters onto obspack IDs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_surface_obs.html">
     Process surface observations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_surface_models.html">
     Process surface model output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_aircraft_models.html">
     Process airborne model output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../process_surface_sf6.html">
     Process surface SF6 observations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../_precompute.html">
     Precompute model data
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Observations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../obs-main.html">
   Observed patterns in atmospheric CO
   <sub>
    2
   </sub>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../obs-aircraft.html">
     Airborne observations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../obs-surface.html">
     Surface observations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../obs-surface-error.html">
     Analytical uncertainty at CO
     <sub>
      2
     </sub>
     measurement stations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../obs-surface-diurnal-variations.html">
     Climatological mean diurnal CO
     <sub>
      2
     </sub>
     cycles since 1999 for four stations with in situ instruments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../obs-simulated-distributions.html">
     Simulated CO
     <sub>
      2
     </sub>
     distributions
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Gradient metrics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../gradients-main.html">
   Gradient metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-seasonal-amplitude.html">
     Seasonal amplitude of vertical gradient
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-trends.html">
     Trend in horizontal gradient metric
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-profiles.html">
     Aircraft atmospheric CO
     <sub>
      2
     </sub>
     profiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-methane.html">
     Observed concentrations and gradients of methane
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-sf6.html">
     Surface observations of SF
     <sub>
      6
     </sub>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../gradients-aircraft-sampling.html">
     Aircraft sampling representativeness
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Emergent constraints
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../emergent-constraint.html">
   Emergent constraints on air-sea fluxes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../emergent-constraint-s2n.html">
     Sensitivity analysis of emergent constraint
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Flux Estimates
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../fluxes.html">
   Estimate of Southern Ocean air-sea CO
   <sub>
    2
   </sub>
   fluxes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../fluxes-aircraft-campaign-table.html">
     Flux estimates for each aircraft campaign
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../api.html">
   API Reference
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api-cli.html">
     Run calculation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api-datasets.html">
     Observational datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../api-emergent-constraint.html">
     Emergent constraints
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  References
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../references.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/_prestage-obs/old-split-ipynb/aircraft_filter_mspo_10s.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/ncar/so-co2-airborne-obs"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/ncar/so-co2-airborne-obs/main?urlpath=tree/so-co2-airborne-obs/_prestage-obs/old-split-ipynb/aircraft_filter_mspo_10s.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Filter airborne 10-sec data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hippo">
   HIPPO
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orcas">
   ORCAS
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#atom">
   ATom
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="filter-airborne-10-sec-data">
<h1>Filter airborne 10-sec data<a class="headerlink" href="#filter-airborne-10-sec-data" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>R Program to filter aircraft data for strong local continental influences, subtract off NOAA in situ SPO, and write out flat text files</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;ncdf4&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#39;yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">project_tmpdir_obs</span> <span class="o">=</span> <span class="nf">read_yaml</span><span class="p">(</span><span class="s">&#39;../_config_calc.yml&#39;</span><span class="p">)</span><span class="o">$</span><span class="n">project_tmpdir_obs</span>
<span class="n">username</span> <span class="o">=</span> <span class="nf">Sys.info</span><span class="p">()[</span><span class="s">&#39;user&#39;</span><span class="p">]</span>
<span class="n">project_tmpdir_obs</span> <span class="o">=</span> <span class="nf">gsub</span><span class="p">(</span><span class="s">&#39;\\{\\{env\\[\&#39;USER\&#39;\\]\\}\\}&#39;</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">project_tmpdir_obs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in preprocessed aircraft files from read_aircraft_10s.r</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&#39;HIPPO_10s.RData&#39;</span><span class="p">)</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&#39;ORCAS_10s.RData&#39;</span><span class="p">)</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&#39;ATom_10s.RData&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate datetime variables</span>
<span class="n">hippodt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">mon</span><span class="p">,</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">day</span><span class="p">,</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">hour</span><span class="p">,</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">min</span><span class="p">,</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">sec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">orcasdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">mon</span><span class="p">,</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">day</span><span class="p">,</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">hour</span><span class="p">,</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">min</span><span class="p">,</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">sec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">atomdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="n">atommerge</span><span class="o">$</span><span class="n">mon</span><span class="p">,</span><span class="n">atommerge</span><span class="o">$</span><span class="n">day</span><span class="p">,</span><span class="n">atommerge</span><span class="o">$</span><span class="n">hour</span><span class="p">,</span><span class="n">atommerge</span><span class="o">$</span><span class="n">min</span><span class="p">,</span><span class="n">atommerge</span><span class="o">$</span><span class="n">sec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in NOAA in situ record from SPO</span>
<span class="n">sponc</span><span class="o">=</span><span class="nf">nc_open</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">project_tmpdir_obs</span><span class="p">,</span><span class="s">&#39;/obspack_co2_1_GLOBALVIEWplus_v6.0_2020-09-11/data/nc/co2_spo_surface-insitu_1_allvalid.nc&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
<span class="n">spoco2</span><span class="o">=</span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="nf">ncvar_get</span><span class="p">(</span><span class="n">sponc</span><span class="p">,</span><span class="s">&#39;time_decimal&#39;</span><span class="p">),</span><span class="nf">t</span><span class="p">(</span><span class="nf">ncvar_get</span><span class="p">(</span><span class="n">sponc</span><span class="p">,</span><span class="s">&#39;time_components&#39;</span><span class="p">)),</span><span class="nf">ncvar_get</span><span class="p">(</span><span class="n">sponc</span><span class="p">,</span><span class="s">&#39;value&#39;</span><span class="p">)</span><span class="o">*</span><span class="m">1E6</span><span class="p">))</span> <span class="p">;</span> <span class="nf">colnames</span><span class="p">(</span><span class="n">spoco2</span><span class="p">)</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;date&#39;</span><span class="p">,</span><span class="s">&#39;year&#39;</span><span class="p">,</span><span class="s">&#39;mon&#39;</span><span class="p">,</span><span class="s">&#39;day&#39;</span><span class="p">,</span><span class="s">&#39;hour&#39;</span><span class="p">,</span><span class="s">&#39;min&#39;</span><span class="p">,</span><span class="s">&#39;sec&#39;</span><span class="p">,</span><span class="s">&#39;co2&#39;</span><span class="p">)</span>
<span class="n">qcflag</span><span class="o">=</span><span class="nf">ncvar_get</span><span class="p">(</span><span class="n">sponc</span><span class="p">,</span><span class="s">&#39;qcflag&#39;</span><span class="p">);</span> <span class="n">spoco2</span><span class="o">$</span><span class="n">co2</span><span class="p">[</span><span class="nf">substr</span><span class="p">(</span><span class="n">qcflag</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="o">!=</span><span class="s">&#39;.&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">NA</span><span class="p">;</span> <span class="n">spoco2</span><span class="o">$</span><span class="n">co2</span><span class="p">[</span><span class="nf">substr</span><span class="p">(</span><span class="n">qcflag</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="o">!=</span><span class="s">&#39;.&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">NA</span>
<span class="n">spodt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">spoco2</span><span class="o">$</span><span class="n">year</span><span class="p">,</span><span class="n">spoco2</span><span class="o">$</span><span class="n">mon</span><span class="p">,</span><span class="n">spoco2</span><span class="o">$</span><span class="n">day</span><span class="p">,</span><span class="n">spoco2</span><span class="o">$</span><span class="n">hour</span><span class="p">,</span><span class="n">spoco2</span><span class="o">$</span><span class="n">min</span><span class="p">,</span><span class="n">spoco2</span><span class="o">$</span><span class="n">sec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="hippo">
<h1>HIPPO<a class="headerlink" href="#hippo" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># filter</span>
<span class="n">ints</span><span class="o">=</span><span class="nf">read.table</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">project_tmpdir_obs</span><span class="p">,</span><span class="s">&#39;/hippo_xsect_filt_datetime.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span> 
<span class="n">startdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">startyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">starthour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">stopdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">stopyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stophour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">blfilt</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="bp">T</span><span class="p">,</span><span class="nf">nrow</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">))</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">ints</span><span class="p">))){</span>
	<span class="n">blfilt</span><span class="p">[</span><span class="nf">difftime</span><span class="p">(</span><span class="n">hippodt</span><span class="p">,</span><span class="n">startdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;=</span><span class="m">0</span><span class="o">&amp;</span><span class="nf">difftime</span><span class="p">(</span><span class="n">hippodt</span><span class="p">,</span><span class="n">stopdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">]</span><span class="o">=</span><span class="bp">F</span>
<span class="p">}</span>
<span class="n">hippodt</span><span class="o">=</span><span class="n">hippodt</span><span class="p">[</span><span class="n">blfilt</span><span class="p">]</span>
<span class="n">hippomerge</span><span class="o">=</span><span class="n">hippomerge</span><span class="p">[</span><span class="n">blfilt</span><span class="p">,]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Filtered &#39;</span><span class="p">,</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; of &#39;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; HIPPO obs (&#39;</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">)</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="s">&#39;%)&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Filtered 2453 of 156551 HIPPO obs (1.6%)&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate differences</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">co2mspo</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="nf">approx</span><span class="p">(</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">spodt</span><span class="p">),</span><span class="n">spoco2</span><span class="o">$</span><span class="n">co2</span><span class="p">,</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">hippodt</span><span class="p">))</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="m">3</span><span class="p">)</span> <span class="c1">## co2 = &#39;CO2.X&#39;</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">co2mqcls</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2qcls</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">co2moms</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2oms</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">co2mao2</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">co2ao2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4mucats</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4qcls</span><span class="o">-</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4ucats</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4mpanther</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4qcls</span><span class="o">-</span><span class="n">hippomerge</span><span class="o">$</span><span class="n">ch4panther</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># write out</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/HIPPO_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">))</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/HIPPO_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">),</span><span class="n">append</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">hippomerge</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="n">sum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       year         mon         day        hour         min         sec 
     154098      154098      154098      154098      154098      154098 
       camp         flt        prof         lat         lon         alt 
     154098      154098      154098      154098      154098      154098 
   pressure       theta         co2     co2qcls      co2oms      co2ao2 
     153643      153642      128532       99731      111351      123678 
    ch4qcls    ch4ucats  ch4panther  sf6panther    sf6ucats      sf6pfp 
     109569        5054        4367       10500       12982        1337 
      strat      h2oref      n2oref       o3ref     co2mspo    co2mqcls 
     154098      149942      111218      150933      128532       97975 
    co2moms     co2mao2   ch4mucats ch4mpanther 
      99249      103284        3696        3275 
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="orcas">
<h1>ORCAS<a class="headerlink" href="#orcas" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># filter</span>
<span class="n">ints</span><span class="o">=</span><span class="nf">read.table</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">project_tmpdir_obs</span><span class="p">,</span><span class="s">&#39;/orcas_xsect_filt_datetime.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="n">startdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">startyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">starthour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">stopdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">stopyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stophour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">blfilt</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="bp">T</span><span class="p">,</span><span class="nf">nrow</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">))</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">ints</span><span class="p">))){</span>
    <span class="n">blfilt</span><span class="p">[</span><span class="nf">difftime</span><span class="p">(</span><span class="n">orcasdt</span><span class="p">,</span><span class="n">startdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;=</span><span class="m">0</span><span class="o">&amp;</span><span class="nf">difftime</span><span class="p">(</span><span class="n">orcasdt</span><span class="p">,</span><span class="n">stopdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">]</span><span class="o">=</span><span class="bp">F</span>
<span class="p">}</span>
<span class="n">orcasdt</span><span class="o">=</span><span class="n">orcasdt</span><span class="p">[</span><span class="n">blfilt</span><span class="p">]</span>
<span class="n">orcasmerge</span><span class="o">=</span><span class="n">orcasmerge</span><span class="p">[</span><span class="n">blfilt</span><span class="p">,]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Filtered &#39;</span><span class="p">,</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; of &#39;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; ORCAS obs (&#39;</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">)</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="s">&#39;%)&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Filtered 1943 of 46646 ORCAS obs (4.2%)&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate differences</span>
<span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2mspo</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="nf">approx</span><span class="p">(</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">spodt</span><span class="p">),</span><span class="n">spoco2</span><span class="o">$</span><span class="n">co2</span><span class="p">,</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">orcasdt</span><span class="p">))</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="m">2</span><span class="p">)</span> <span class="c1">## co2 = &#39;CO2.X&#39;</span>
<span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2mqcls</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2qcls</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2mnoaa</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2noaa</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2mao2</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">co2ao2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">orcasmerge</span><span class="o">$</span><span class="n">ch4mqcls</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">ch4noaa</span><span class="o">-</span><span class="n">orcasmerge</span><span class="o">$</span><span class="n">ch4qcls</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># write out</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/ORCAS_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">))</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/ORCAS_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">),</span><span class="n">append</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">orcasmerge</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="n">sum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    year      mon      day     hour      min      sec      flt     prof 
   44703    44703    44703    44703    44703    44703    44703    44703 
     lat      lon      alt pressure    theta      co2  co2qcls  co2noaa 
   44703    44703    44703    44581    44580    38560    16277    34251 
  co2ao2  ch4noaa  ch4qcls    strat   h2oref   n2oref  co2mspo co2mqcls 
   31753    34254    23452    44703    44440    22462    38560    15105 
co2mnoaa  co2mao2 ch4mqcls 
   34251    29649    21267 
</pre></div>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="atom">
<h1>ATom<a class="headerlink" href="#atom" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># filter</span>
<span class="n">ints</span><span class="o">=</span><span class="nf">read.table</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="n">project_tmpdir_obs</span><span class="p">,</span><span class="s">&#39;/atom_xsect_filt_datetime.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">header</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>
<span class="n">startdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">startyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">starthour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">startsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">stopdt</span><span class="o">=</span><span class="nf">ISOdatetime</span><span class="p">(</span><span class="n">ints</span><span class="o">$</span><span class="n">stopyear</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmon</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopday</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stophour</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopmin</span><span class="p">,</span><span class="n">ints</span><span class="o">$</span><span class="n">stopsec</span><span class="p">,</span><span class="n">tz</span><span class="o">=</span><span class="s">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">blfilt</span><span class="o">=</span><span class="nf">rep</span><span class="p">(</span><span class="bp">T</span><span class="p">,</span><span class="nf">nrow</span><span class="p">(</span><span class="n">atommerge</span><span class="p">))</span>
<span class="nf">for</span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">ints</span><span class="p">))){</span>
    <span class="n">blfilt</span><span class="p">[</span><span class="nf">difftime</span><span class="p">(</span><span class="n">atomdt</span><span class="p">,</span><span class="n">startdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&gt;=</span><span class="m">0</span><span class="o">&amp;</span><span class="nf">difftime</span><span class="p">(</span><span class="n">atomdt</span><span class="p">,</span><span class="n">stopdt</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&lt;=</span><span class="m">0</span><span class="p">]</span><span class="o">=</span><span class="bp">F</span>
<span class="p">}</span>
<span class="n">atomdt</span><span class="o">=</span><span class="n">atomdt</span><span class="p">[</span><span class="n">blfilt</span><span class="p">]</span>
<span class="n">atommerge</span><span class="o">=</span><span class="n">atommerge</span><span class="p">[</span><span class="n">blfilt</span><span class="p">,]</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&#39;Filtered &#39;</span><span class="p">,</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; of &#39;</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">),</span><span class="s">&#39; ATom obs (&#39;</span><span class="p">,</span><span class="nf">round</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="o">!</span><span class="n">blfilt</span><span class="p">)</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="n">blfilt</span><span class="p">)</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">),</span><span class="s">&#39;%)&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Filtered 4218 of 149133 ATom obs (2.8%)&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate differences</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">co2mspo</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="nf">approx</span><span class="p">(</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">spodt</span><span class="p">),</span><span class="n">spoco2</span><span class="o">$</span><span class="n">co2</span><span class="p">,</span><span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">atomdt</span><span class="p">))</span><span class="o">$</span><span class="n">y</span><span class="p">,</span><span class="m">2</span><span class="p">)</span> <span class="c1">## co2 = &#39;CO2_NOAA&#39;</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">co2mqcls</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2qcls</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">co2mao2</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2ao2</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">co2mx</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">co2x</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">ch4mqcls</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4noaa</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4qcls</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">ch4mucats</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4noaa</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4ucats</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
<span class="n">atommerge</span><span class="o">$</span><span class="n">ch4mpanther</span><span class="o">=</span><span class="nf">round</span><span class="p">(</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4noaa</span><span class="o">-</span><span class="n">atommerge</span><span class="o">$</span><span class="n">ch4panther</span><span class="p">,</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># write out</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">atommerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/ATOM_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">atommerge</span><span class="p">))</span>
<span class="nf">write</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">atommerge</span><span class="p">),</span><span class="s">&#39;../data/aircraft-obs/ATOM_SO_mSPO.txt&#39;</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="nf">ncol</span><span class="p">(</span><span class="n">atommerge</span><span class="p">),</span><span class="n">append</span><span class="o">=</span><span class="bp">T</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">atommerge</span><span class="p">),</span><span class="m">2</span><span class="p">,</span><span class="n">sum</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       year         mon         day        hour         min         sec 
     144915      144915      144915      144915      144915      144915 
       camp         flt        prof         lat         lon         alt 
     144915      144915      144915      144915      144915      144915 
   pressure       theta         co2     co2qcls      co2ao2        co2x 
     144853      144853      131654       97026      119777      136261 
    ch4noaa     ch4qcls    ch4ucats  ch4panther  sf6panther    sf6ucats 
     136496       75929        6802        7077       15072       13949 
      strat      h2oref      n2oref       o3ref     co2mspo    co2mqcls 
     144915      144770       88108      144781      131654       86894 
    co2mao2       co2mx    ch4mqcls   ch4mucats ch4mpanther 
     108784      130545       71604        6407        6703 
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-miniconda3-so-co2-R-r"
        },
        kernelOptions: {
            kernelName: "conda-env-miniconda3-so-co2-R-r",
            path: "./_prestage-obs/old-split-ipynb"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-miniconda3-so-co2-R-r'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Matthew C. Long and Britton B. Stephens<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>